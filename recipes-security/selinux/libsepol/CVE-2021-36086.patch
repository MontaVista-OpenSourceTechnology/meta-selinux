From e6f40f8caa745bca68d183dafdc253a6db422ab5 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 23 Nov 2022 10:19:17 +0000
Subject: [PATCH] CVE-2021-36086

---
 cil/src/cil_reset_ast.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/cil/src/cil_reset_ast.c b/cil/src/cil_reset_ast.c
index 20bc3b9..785a7f7 100644
--- a/cil/src/cil_reset_ast.c
+++ b/cil/src/cil_reset_ast.c
@@ -57,7 +57,11 @@ static void cil_reset_classpermission(struct cil_classpermission *cp)
 
 static void cil_reset_classperms_set(struct cil_classperms_set *cp_set)
 {
-	cil_reset_classpermission(cp_set->set);
+	if (cp_set == NULL) {
+		return;
+	}
+
+	cp_set->set = NULL;
 }
 
 static inline void cil_reset_classperms_list(struct cil_list *cp_list)
-- 
2.18.2

